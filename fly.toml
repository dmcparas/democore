app = "democore"
primary_region = "lhr"

[build]
dockerfile = "Dockerfile"

[[services]]
# gRPC service
internal_port = 9090
protocol = "tcp"

[[services.ports]]
port = 9090          # External port for gRPC
# no handlers â†’ raw TCP for gRPC

[[services.tcp_checks]]
interval = "15s"
timeout = "2s"
grace_period = "10s"

[[services]]
# HTTP service
internal_port = 8080
protocol = "tcp"

[[services.ports]]
port = 80            # External port for HTTP
handlers = ["http"]
[[services.ports]]
port = 443
handlers = ["tls", "http"]# Edge HTTP handler for REST

[[services.tcp_checks]]
interval = "15s"
timeout = "2s"
grace_period = "10s"
# Kafka Broker Service
[[services]]
internal_port = 9092          # Kafka broker's internal port
protocol = "tcp"

# Optional: make Kafka reachable publicly (for debugging)
# If you only want it reachable to other Fly apps, this alone is enough.
[[services.ports]]
port = 9092                   # External port for Kafka broker (TCP)
# handlers = ["tls"]          # uncomment if Kafka uses TLS; otherwise plain TCP

[[services.tcp_checks]]
interval = "15s"
timeout = "2s"
grace_period = "60s"

# fly.toml for zookeeper
app = "zk"
[[services]]
internal_port = 2181
protocol = "tcp"
[[services.ports]]
port = 2181
